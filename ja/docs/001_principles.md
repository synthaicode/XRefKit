<!-- xid: 71DFD9319CFB -->
<a id="xid-71DFD9319CFB"></a>

# 設計原則（Contract）

このリポジトリの目的は「全部読ませる」ではなく、**必要な断片だけを正しく参照して読める**状態を作ることです。

## 原則

1. **参照の主キーは XID**
   - パスやファイル名は変わる前提
   - 参照は `#xid-...` を含める（`rewrite` で復旧可能にする）
2. **入口（L0）と詳細（L1/L2）を分離**
   - 入口は短く固定（毎回必ず読む）
   - 詳細は増えてよい（必要時だけ読む）
3. **断片は自己完結**
   - 1ページ/1断片が単体で意味を持つ（前提・条件・結論が欠けない）
4. **自動化は登録と検査に寄せる**
   - 取り込み元（PDF/Excel/Web）は揺れる前提で無理に統一しない
   - 代わりに Markdown 化された成果物を機械で担保する（XID/リンク/索引）

## 禁止事項（リンク資産を守る）

- 既存ページの XID を差し替えない（参照が死ぬ）
- 参照のあるページを、参照の付け替え無しに削除しない

## XID を変える時の原則（意味を壊さない）

「同じ XID のままでは別物になる」と判断した場合は、旧ページを消したり別物に置き換えたりせず、**旧→新の関係を明示して互換を保つ**。

- 重要: XID の変更は機械的な都合ではなく、**その ID が指す意味（サービス/機能/概念）を変える判断**を伴う（人間レビューが必要）
- 新しい意味は新ページ（新 XID）に置く
- 旧ページ（旧 XID）は残し、後継（新 XID）へのリンクを置く
- 新ページ側にも前身（旧 XID）を記す

運用を揃えるために次を推奨:

```powershell
python -m fm xref deprecate <OLD_XID> <NEW_XID> --note "変更理由（任意）"
```
